# Time Tracker for Arch Linux + Hyprland

A beautiful, privacy-focused time tracking application designed for Arch Linux with Hyprland/Wayland compositor.

## Features

- ðŸŽ¯ **Automatic Tracking**: Tracks all applications and active windows under Hyprland/Wayland
- ðŸ“Š **Beautiful Dashboard**: Modern React frontend with interactive charts and timelines
- ðŸ’¾ **Local Storage**: All data stored locally in SQLite3 database
- ðŸš€ **Background Service**: Runs automatically on startup via systemd
- ðŸ“ˆ **Analytics**: Daily/weekly timelines, time spent per app, productivity graphs
- ðŸ”’ **Privacy First**: All data stays on your machine

## Architecture

- **Backend**: FastAPI (Python) - REST API and data collection
- **Frontend**: React + Vite + Recharts - Beautiful, responsive UI
- **Database**: SQLite3 - Local data storage
- **Tracker**: Python daemon monitoring Hyprland windows
- **Service**: systemd user service for automatic startup

## Prerequisites

```bash
# Install required system packages
sudo pacman -S python python-pip sqlite nodejs npm

# Install Hyprland (if not already installed)
sudo pacman -S hyprland
```

## Installation

### 1. Clone/Navigate to the project directory
```bash
cd /home/em/Desktop/Tracker
```

### 2. Set up the Backend
```bash
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 3. Set up the Frontend
```bash
cd ../frontend
npm install
npm run build
```

### 4. Install the systemd service
```bash
cd ..
./install.sh
```

This will:
- Install the systemd user service
- Enable it to start on boot
# Time Tracker for Arch Linux + Hyprland

A privacy-first time tracking application for Hyprland/Wayland (Arch Linux tested).
This repository contains a small FastAPI backend, a React + Vite frontend, a local
SQLite database, and a systemd user service to run the tracker in the background.

Key goals: keep data local, provide an easy UI for reviewing tracked time, and
support manual task grouping (folders + tasks).

Table of contents
- Features
- Quickstart (install + run)
- Development
- API reference (common endpoints)
- Project layout
- Configuration & data
- Troubleshooting
- License

## Features

- Automatic active-window tracking (Hyprland via `hyprctl`, X11 fallback supported)
- Local storage using SQLite (no remote telemetry)
- Web dashboard (React + Vite) with charts and per-task statistics
- Manual tasks/folders to group tracked time
- systemd user service for automatic startup

## Quickstart (Install & Run)

These instructions assume you cloned the repo to `/home/em/Desktop/Tracker`.

1) Backend

```bash
cd /home/em/Desktop/Tracker/backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

2) Frontend

```bash
cd /home/em/Desktop/Tracker/frontend
npm install
npm run build
```

3) Install systemd user service (provided install script)

```bash
cd /home/em/Desktop/Tracker
./install.sh
```

The installer will build the frontend, create a Python virtualenv (backend),
install dependencies and install/enable a systemd user service named
`timetracker.service` (it will be started automatically).

4) Open dashboard

Visit: http://localhost:8000

API docs (auto-generated by FastAPI): http://localhost:8000/docs

## Development

Run both backend and frontend in development mode (with hot reload):

```bash
# Start backend with auto-reload (from repo root)
./dev.sh

# Or separately:
cd backend
source venv/bin/activate
python main.py

cd frontend
npm run dev
```

`dev.sh` starts the backend (uvicorn) and the Vite dev server and proxies API calls
so the UI talks to the running backend.

## API Reference (common endpoints)

The backend exposes a REST API (see `backend/main.py`). Common endpoints used by
the frontend include:

- GET `/api/health` - service health info
- GET `/api/tracker/status` - tracker runtime status (running, current app/window)
- POST `/api/tracker/start?task_id=<id>` - start tracking for a task
- POST `/api/tracker/stop` - stop tracking

- GET `/api/tasks` - list tasks (supports `?folder_id=`)
- POST `/api/tasks?title=...&description=...&folder_id=...` - create a task
- GET `/api/tasks/{task_id}` - get task
- DELETE `/api/tasks/{task_id}` - delete task
- POST `/api/tasks/{task_id}/move` - move a task into another folder
- GET `/api/tasks/{task_id}/stats` - per-task statistics (apps, sessions, durations)

- GET `/api/folders` - list folders (includes task counts and total durations)
- POST `/api/folders` - create folder ({ "name": "..." })
- PATCH `/api/folders/{id}` - rename folder ({ "name": "..." })
- DELETE `/api/folders/{id}` - delete folder (tasks reassigned to default)

- GET `/api/timeline?date=YYYY-MM-DD` - activity timeline for a date
- GET `/api/stats/summary` - high level summary (today, week, last 30 days)

Notes:
- Most endpoints return JSON. The dashboard consumes these endpoints directly.
- For development you can browse `/docs` to try endpoints live.

## Project layout

```
Tracker/
â”œâ”€ backend/
â”‚  â”œâ”€ main.py            # FastAPI application + endpoints
â”‚  â”œâ”€ tracker.py         # Hyprland/X11 tracker implementation
â”‚  â”œâ”€ database.py        # SQLite helper + queries
â”‚  â”œâ”€ config.py          # application configuration
	â”‚  â””â”€ requirements.txt  # Python deps
â”œâ”€ frontend/
â”‚  â”œâ”€ src/
â”‚  â”‚  â”œâ”€ App.jsx         # Main React UI
â”‚  â”‚  â””â”€ main.jsx        # Frontend entry
â”‚  â”œâ”€ package.json
â”‚  â””â”€ vite.config.js
â”œâ”€ timetracker.service   # systemd user unit (install.sh uses this)
â”œâ”€ install.sh            # installer script (creates venv + builds frontend + installs service)
â”œâ”€ uninstall.sh
â””â”€ README.md
```

## Configuration & data

- Database file: `backend/timetracker.db` (SQLite)
- Edit `backend/config.py` for:
	- API port
	- DB path
	- TRACKER_POLL_INTERVAL
	- IDLE_TIMEOUT

Back up your data:

```bash
cp backend/timetracker.db backend/backup_$(date +%Y%m%d).db
```

Restore example:

```bash
systemctl --user stop timetracker
cp ~/timetracker_backup.db backend/timetracker.db
systemctl --user start timetracker
```

## Troubleshooting

- Check service status and logs:

```bash
systemctl --user status timetracker
journalctl --user -u timetracker -f
```

- If the tracker cannot see windows:
	- Ensure Hyprland is running and `hyprctl` is available
	- Check `echo $HYPRLAND_INSTANCE_SIGNATURE`
	- Fallback: ensure `xdotool` is installed for X11

- Frontend problems:

```bash
cd frontend
npm install
npm run build
systemctl --user restart timetracker
```

- Database errors: run a quick integrity check or restore a backup

## Development notes and tips

- The frontend fetches `/api/timeline` and `/api/stats/summary` regularly to update
	the dashboard. If you change endpoint names, update the URLs in `frontend/src/App.jsx`.
- Be careful when changing database schemas â€” SQLite ALTER TABLE is limited. Use
	the `backend` code and migration scripts if you add columns/tables.

## Uninstall

```bash
systemctl --user stop timetracker
systemctl --user disable timetracker
rm ~/.config/systemd/user/timetracker.service
systemctl --user daemon-reload
# optionally remove project folder
# rm -rf /home/em/Desktop/Tracker
```

## License

MIT

## Contributing

This is a personal project. Contributions and improvements are welcome â€” open a
PR or issue describing the change.
